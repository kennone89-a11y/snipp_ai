<!DOCTYPE html>
<html lang="sv">
  <head>
    <meta charset="UTF-8" />
    <title>Kenai Timestamps ‚Äì YouTube & poddar</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Kenai favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32 (1).png" />

    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        min-height: 100vh;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
          sans-serif;
        background: radial-gradient(circle at top, #07111f 0, #02152a 40%, #000000 100%);
        color: #f5f5ff;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 24px;
      }

      a {
        color: #7dd3fc;
        text-decoration: none;
      }

      a:hover {
        text-decoration: underline;
      }

      .page {
        width: 100%;
        max-width: 1000px;
        border-radius: 24px;
        padding: 28px 32px 32px;
        background: rgba(5, 12, 32, 0.96);
        border: 1px solid rgba(77, 189, 255, 0.25);
        box-shadow: 0 40px 90px rgba(0, 0, 0, 0.9);
      }

      .back-link {
        font-size: 12px;
        margin-bottom: 18px;
        opacity: 0.8;
      }

      h1 {
        font-size: 24px;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        color: #e5f3ff;
        margin-bottom: 6px;
      }

      .subtitle {
        font-size: 13px;
        color: #aab6ff;
        margin-bottom: 24px;
      }

      .section {
        border-radius: 18px;
        border: 1px solid rgba(120, 166, 255, 0.4);
        background: radial-gradient(circle at top left, #0b1430 0, #050a1a 45%, #02030a 100%);
        padding: 18px 18px 16px;
        margin-bottom: 18px;
      }

      .section-title {
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.18em;
        color: #8cb3ff;
        margin-bottom: 14px;
      }

      .row {
        display: flex;
        gap: 16px;
        flex-wrap: wrap;
      }

      .col {
        flex: 1 1 0;
        min-width: 0;
      }

      label {
        font-size: 12px;
        color: #c2cffc;
        display: block;
        margin-bottom: 6px;
      }

      input[type="text"] {
        width: 100%;
        border-radius: 999px;
        border: 1px solid rgba(126, 169, 255, 0.45);
        background: rgba(2, 5, 20, 0.95);
        color: #f6f7ff;
        padding: 10px 16px;
        font-size: 13px;
        outline: none;
      }

      input[type="text"]::placeholder {
        color: #59607c;
      }

      input[type="text"]:focus {
        border-color: #4dd4ff;
        box-shadow: 0 0 0 1px rgba(77, 212, 255, 0.4);
      }

      .btn-row {
        margin-top: 10px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      button.primary {
        border-radius: 999px;
        border: none;
        padding: 9px 18px;
        font-size: 12px;
        font-weight: 600;
        cursor: pointer;
        background: linear-gradient(135deg, #4ddeff, #8b6bff);
        color: #050816;
        box-shadow: 0 14px 40px rgba(43, 190, 255, 0.6);
        transition: transform 0.15s ease, box-shadow 0.15s ease, filter 0.15s ease;
        white-space: nowrap;
      }

      button.primary:hover {
        transform: translateY(-1px);
        filter: brightness(1.06);
        box-shadow: 0 18px 50px rgba(82, 197, 255, 0.9);
      }

      button.primary:disabled {
        opacity: 0.6;
        cursor: default;
        transform: none;
        box-shadow: none;
      }

      .hint {
        font-size: 11px;
        color: #7f8ab0;
        margin-top: 6px;
      }

      .result-grid {
        display: grid;
        grid-template-columns: minmax(0, 2.1fr) minmax(0, 1fr);
        gap: 16px;
      }

      .card {
        border-radius: 16px;
        border: 1px solid rgba(110, 160, 255, 0.35);
        background: radial-gradient(circle at top left, #070f26 0, #050716 50%, #020309 100%);
        padding: 16px 16px 14px;
        min-height: 126px;
      }

      .card-title {
        font-size: 11px;
        text-transform: uppercase;
        letter-spacing: 0.16em;
        color: #8da2ff;
        margin-bottom: 10px;
      }

      .title-output {
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 8px;
        color: #f3f5ff;
      }

      .summary-output {
        font-size: 12px;
        color: #b8c2ff;
        line-height: 1.5;
        white-space: pre-wrap;
      }

      .hashtags {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
      }

      .hashtags code {
        font-family: inherit;
        font-size: 11px;
        background: rgba(20, 34, 80, 0.95);
        border-radius: 999px;
        padding: 4px 10px;
        border: 1px solid rgba(149, 196, 255, 0.45);
        color: #d9e6ff;
      }

      .chapters {
        list-style: none;
        margin-top: 4px;
      }

      .chapters li {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 6px 4px;
        border-bottom: 1px solid rgba(37, 55, 104, 0.65);
        font-size: 12px;
        color: #d5ddff;
      }

      .chapters li:last-child {
        border-bottom: none;
      }

      .chapter-time {
        font-family: "SF Mono", ui-monospace, Menlo, Monaco, Consolas,
          "Liberation Mono", "Courier New", monospace;
        font-size: 11px;
        color: #9fd5ff;
        min-width: 52px;
      }

      .status-bar {
        margin-top: 10px;
        font-size: 11px;
        color: #7b87b2;
        display: flex;
        justify-content: space-between;
        gap: 10px;
        align-items: center;
      }

      .ai-status {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-size: 11px;
        color: #a5b8ff;
        min-height: 18px;
      }

      .ai-status.done {
        color: #6efacc;
      }

      .ai-pulse {
        width: 9px;
        height: 9px;
        border-radius: 999px;
        background: radial-gradient(circle, #6efacc 0, #12f7ff 40%, #0b1836 100%);
        box-shadow: 0 0 12px rgba(110, 250, 204, 0.9);
        animation: ai-pulse 1.6s ease-in-out infinite;
      }

      @keyframes ai-pulse {
        0% {
          transform: scale(0.9);
          opacity: 0.7;
        }
        50% {
          transform: scale(1.2);
          opacity: 1;
        }
        100% {
          transform: scale(0.9);
          opacity: 0.7;
        }
      }

      @media (max-width: 768px) {
        body {
          padding: 16px;
        }
        .page {
          padding: 20px 16px 22px;
        }
        .result-grid {
          grid-template-columns: minmax(0, 1fr);
        }
      }     .chapter-timeline {
  position: relative;
  margin-top: 16px;
  height: 10px;
  border-radius: 999px;
  background: linear-gradient(
    90deg,
    rgba(0, 255, 255, 0.25),
    rgba(138, 180, 255, 0.5)
  );
  box-shadow: 0 0 20px rgba(0, 200, 255, 0.35);
  overflow: visible;
}

.chapter-marker {
  position: absolute;
  top: -4px;
  width: 10px;
  height: 18px;
  border-radius: 999px;
  background: #00f2ff;
  box-shadow: 0 0 16px rgba(0, 242, 255, 0.9);
  cursor: pointer;
}

.chapter-marker .chapter-tooltip {
  position: absolute;
  left: 50%;
  bottom: 30px;
  transform: translateX(-50%) translateY(8px);
  padding: 6px 10px;
  border-radius: 999px;
  background: rgba(10, 18, 40, 0.95);
  border: 1px solid rgba(0, 242, 255, 0.5);
  font-size: 11px;
  white-space: nowrap;
  color: #e6f1ff;
  box-shadow: 0 0 18px rgba(0, 242, 255, 0.6);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.18s ease, transform 0.18s ease;
  z-index: 5;
}

.chapter-marker:hover .chapter-tooltip {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

    </style>
  </head>
  <body>
    <div class="page">
      <div class="back-link">
        <a href="index.html">&larr; Tillbaka till Kenai-hubben</a>
      </div>

      <h1>AI-timestamps &amp; beskrivning f√∂r YouTube &amp; poddar</h1>
      <p class="subtitle">
        Klistra in en video- eller podd-URL s√• hj√§lper Kenai dig att skapa kapitel,
        sammanfattning och hashtags ‚Äì klart att klistra in direkt i beskrivningen.
      </p>

      <!-- 1 ‚Äì URL -->
      <section class="section">
        <div class="section-title">1 ‚Äì Klistra in URL</div>
        <label for="urlInput">YouTube-l√§nk, podd-l√§nk eller annan publik video/podd-URL</label>
        <input
          id="urlInput"
          type="text"
          placeholder="https://www.youtube.com/watch?v=..."
        />
        <div class="btn-row">
          <button id="generateBtn" class="primary">Generera timestamps med AI</button>
        </div>
        <p class="hint">
          Kenai l√§ser inneh√•llet och f√∂resl√•r kapitel, kort sammanfattning och n√•gra hashtags
          baserat p√• din URL.
        </p>
        <div class="ai-status" id="aiStatus"></div>
      </section>

      <!-- 2 ‚Äì Resultat -->
      <section class="section">
        <div class="section-title">2 ‚Äì Resultat</div>

        <div class="result-grid">
          <div class="card">
            <div class="card-title">Titel &amp; sammanfattning</div>
            <div id="titleOutput" class="title-output">
              Titel h√§mtas n√§r AI √§r klar‚Ä¶
            </div>
            <div id="summaryOutput" class="summary-output">
              Sammanfattning av videon/podden dyker upp h√§r n√§r AI √§r klar.
            </div>
          </div>

          <div class="card">
            <div class="card-title">Hashtags</div>
            <div id="hashtagsOutput" class="hashtags">
              <code>#kenai</code>
              <code>#ai</code>
              <code>#timestamps</code>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top: 16px">
          <div class="card-title">Kapitel</div>
          <ul id="chaptersOutput" class="chapters">
            <div id="chapterTimeline" class="chapter-timeline"></div> 
            <li>
              <span class="chapter-time">00:00</span>
              <span>Intro</span>
            </li>
            <li>
              <span class="chapter-time">00:30</span>
              <span>Exempelkapitel</span>
            </li>
            <li>
              <span class="chapter-time">01:00</span>
              <span>Avslutning</span>
            </li>
          </ul>
        </div>
      </section>

      <!-- Status -->
      <div class="status-bar">
        <span id="statusText">Redo att generera timestamps.</span>
        <span style="opacity: 0.6; font-size: 10px"
          >Obs. Detta √§r en tidig Kenai-prototyp.</span
        >
      </div>
    </div>

      <script>
      (function () {
        var urlInput = document.getElementById('urlInput');
        var generateBtn = document.getElementById('generateBtn');
        var aiStatusEl = document.getElementById('aiStatus');
        var statusEl = document.getElementById('statusText');
        var titleOutput = document.getElementById('titleOutput');
        var summaryOutput = document.getElementById('summaryOutput');
        var chaptersOutput = document.getElementById('chaptersOutput');
        var hashtagsOutput = document.getElementById('hashtagsOutput');

        function setStatus(msg) {
          if (statusEl) statusEl.textContent = msg || '';
          console.log('STATUS:', msg);
        }

        function setAIStatus(message, done) {
          if (!aiStatusEl) return;
          if (!message) {
            aiStatusEl.textContent = '';
            aiStatusEl.classList.remove('done');
            return;
          }
          if (typeof done === 'undefined') done = false;

          aiStatusEl.classList.toggle('done', !!done);
          aiStatusEl.innerHTML =
            '<span class="ai-pulse"></span>' +
            '<span>' + message + '</span>';
        }

        function renderResult(json) {
          var title =
            json.title ||
            json.videoTitle ||
            json.podcastTitle ||
            'Ingen titel hittades automatiskt.';

          var summary =
            json.summary ||
            json.description ||
            json.text ||
            'Ingen sammanfattning hittades automatiskt.';

          var chapters = json.chapters || json.mockChapters || json.toc || [];
          var hashtags = json.hashtags || json.tags || [];

          titleOutput.textContent = json.title || "AI: Titel kunde inte extraheras automatiskt.";

summaryOutput.textContent =
  json.summary
    ? json.summary
    : `Denna video verkar inneh√•lla flera tematiska segment. AI:n kunde inte h√§mta 
        en exakt sammanfattning fr√•n k√§llan, men h√§r √§r en uppskattning:

‚Ä¢ √ñvergripande tema ‚Äì Introduktion till √§mnet och varf√∂r det √§r relevant.
‚Ä¢ Viktiga punkter ‚Äì Sammanfattning av centrala id√©er som presenteras i videon.
‚Ä¢ Slutsats ‚Äì Vad tittaren ska ta med sig eller t√§nka vidare p√•.

(OBS: Detta √§r en tidig prototyp av Kenai Timestamps.)`;


          chaptersOutput.innerHTML = '';
          if (Object.prototype.toString.call(chapters) === '[object Array]' && chapters.length > 0) {
            chapters.forEach(function (ch) {
              var li = document.createElement('li');

              var t = document.createElement('span');
              t.className = 'chapter-time';
              t.textContent = ch.time || ch.timestamp || '00:00';

              var label = document.createElement('span');
              label.textContent = ch.title || ch.label || ch.text || 'Kapitel';

              li.appendChild(t);
              li.appendChild(label);
              chaptersOutput.appendChild(li);
            });
          } else {
            var li = document.createElement('li');
           li.textContent = `${c.time} ‚Äì ${c.title || "Kapitel"}`;
            chaptersOutput.appendChild(li);
          }
hashtagsOutput.innerHTML = (json.hashtags && json.hashtags.length)
  ? json.hashtags.map(tag => `<code>${tag}</code>`).join("")
  : `<code>#AI</code><code>#timestamps</code><code>#kenai</code>`;


          if (Object.prototype.toString.call(hashtags) === '[object Array]' && hashtags.length > 0) {
            hashtags.forEach(function (tag) {
              var code = document.createElement('code');
              code.textContent = tag;
              hashtagsOutput.appendChild(code);
            });
          } else {
            var code = document.createElement('code');
            code.textContent = '#kenai';
            hashtagsOutput.appendChild(code);
          }
        }

        async function generateTimestamps() {
    var url = (urlInput.value || '').trim();

    // UI: AI b√∂rjar jobba
    aiStatusEl.textContent = 'AI jobbar‚Ä¶ analyserar din l√§nk üîç';
    generateBtnEl.disabled = true;
    generateBtnEl.textContent = 'AI jobbar‚Ä¶';

    if (!url) {
        setStatus('Skriv in en URL f√∂rst.');
        urlInput.focus();
        return;
    }


          try {
            generateBtn.disabled = true;
            setStatus('Skickar URL till Kenai‚Ä¶');
            setAIStatus('AI analyserar din video/podd‚Ä¶', false);

           var backendBase = 'https://snipp-ai1.onrender.com';

const controller = new AbortController();
const timeout = setTimeout(() => controller.abort(), 20000);

    try {
      const res = await fetch(backendBase + '/api/timestamps', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ url }),
        signal: controller.signal
      });

      clearTimeout(timeout);

      const txt = await res.text();
      let json = null;

      // F√∂rs√∂k tolka svaret som JSON
      try {
        json = JSON.parse(txt);
      } catch (e) {
        console.warn('Kunde inte parsa JSON, r√•-text:', txt);
      }

      if (!res.ok) {
        const msg =
          (json && (json.error || json.message)) ||
          txt ||
          'Ok√§nt fel fr√•n backend.';

        aiStatusEl.textContent = 'Fel: Kunde inte generera timestamps ‚úñ';
        generateBtnEl.disabled = false;
        generateBtnEl.textContent = 'F√∂rs√∂k igen';

        throw new Error(String(msg).slice(0, 300));
      }

      if (!json) {
        throw new Error('Tomt svar fr√•n timestamps-backend.');
      }

      // UI: AI klar
      aiStatusEl.textContent = 'Klar! Timestamps genererade ‚úÖ';
      generateBtnEl.disabled = false;
      generateBtnEl.textContent = 'Generera timestamps med AI';

      console.log('Timestamps JSON:', json);
      renderResult(json);
      // TODO: h√§r uppdaterar du titel, kapitel, hashtags med json
     

    } catch (error) {
      clearTimeout(timeout);
      console.error('Fel vid timestamps-anrop:', error);
      aiStatusEl.textContent = 'N√•got gick fel. F√∂rs√∂k igen.';
      generateBtnEl.disabled = false;
      generateBtnEl.textContent = 'Generera timestamps med AI';
    }

        if (generateBtn) {
          generateBtn.addEventListener('click', function () {
            generateTimestamps();
          });
        }

        if (urlInput) {
          urlInput.addEventListener('keydown', function (e) {
            if (e.key === 'Enter') {
              e.preventDefault();
              generateTimestamps();
            }
          });
        }
      })();
   

    </script>
  </body>
</html>

